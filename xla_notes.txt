main process (on the host node)

- Instantiate the model
- Instantiate the wrapped model using xmp.MpModelWrapper (optional)

Data pipeline
- Instantiate an xmp.MpSerialExecutor() for use later
- instantiate Dataset

Within each spawned process, setup (the _mp_fn)

- call torch.manual_seed(...)
- obtain the device (xm.xla_device())
- move the model to the device

Data pipeline
- dataset = xmp.MpSerialExecutor.run(dataset) (optional)
- instantiate the distributed sampler
- instantiate a DataLoader 
- instantiate pl.ParallelLoader (pl.ParallelLoader(loader, [device])  )
- obtain a per-device loader using para_loader.per_device_loader(device)


- call the train_loop function

Within each spawned process, train_loop:

- call xm.optimizer_step(optimizer)


